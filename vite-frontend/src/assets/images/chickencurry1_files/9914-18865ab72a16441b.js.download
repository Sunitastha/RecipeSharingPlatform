!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="7e4dac0e-974b-42e1-a45c-7668fefd1aa7",e._sentryDebugIdIdentifier="sentry-dbid-7e4dac0e-974b-42e1-a45c-7668fefd1aa7")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9914],{69914:function(e,t,r){r.d(t,{l:function(){return y}});var a=r(78931),n=r(82129),i=r(81092),o=r(69025),c=r(72898),l=r(68201),u=r(20667),s=r(61218),d=r(86520);let y=()=>{let e=(0,a.NL)(),t=(0,c.nO)(),{searchTerm:r}=(0,u.p)(),{threadMetadata:y}=(0,l.a0)(),{clearSidebarRecentItems:p,removeItemFromSidebar:m}=(0,i.f)(),h=[d.Tb,{search_term:null!=r?r:""}],{mutate:f}=(0,n.D)({mutationKey:["removeWidget"],mutationFn:e=>{let{entryUUID:t,data:r}=e;return(0,o.UF)(t,r.url,y.rwToken)},onMutate:async t=>{let{entryUUID:r,data:a}=t;await e.cancelQueries(["results",{frontend_context_uuid:y.frontendContextUUID}]),e.setQueryData(["results",{frontend_context_uuid:y.frontendContextUUID}],e=>e.map(e=>(e.backend_uuid===r&&(a.is_widget&&(e.widget_data=e.widget_data.filter(e=>e.url!==a.url)),a.is_knowledge_card&&(e.knowledge_cards=e.knowledge_cards.filter(e=>e.url!==a.url))),e)))}}),{mutate:_}=(0,n.D)({mutationFn:async()=>{if(!t)throw Error("No socket connection");await t.emitWithAck("delete_all_threads")},onMutate:async()=>{p(),await e.cancelQueries(h),await e.cancelQueries(s.Xt);let t=e.getQueryData(h),r=e.getQueryData(s.Xt);return e.setQueryData(s.Xt,e=>{let t=e.pages.map(e=>e.map(e=>({...e,thread_count:0})));return{...e,pages:t}}),e.setQueryData(h,e=>({...e,pages:[]})),{previousThreads:t,previousCollections:r}},onSettled:(t,r,a,n)=>{r?(e.setQueryData(h,n.previousThreads),e.setQueryData(s.Xt,n.previousCollections)):(e.invalidateQueries({queryKey:h}),e.invalidateQueries({queryKey:s.Xt}))}}),{mutate:w}=(0,n.D)({mutationFn:async e=>{let{entryUUID:r,callback:a}=e;if(!t)throw Error("No socket connection");null==a||a(),await t.emitWithAck("delete_thread_by_entry_uuid",r,{read_write_token:null==y?void 0:y.rwToken}),m(r)},onMutate:async t=>{let{entryUUID:r,collectionSlug:a}=t;await e.cancelQueries(h),await e.cancelQueries(s.Xt);let n=e.getQueryData(h),i=e.getQueryData(s.Xt);return e.setQueryData(h,e=>{let t=(e=e||{pages:[],pageParams:[]}).pages.map(e=>e.filter(e=>e.uuid!==r));return{...e,pages:t}}),a&&(e.setQueryData(s.Xt,e=>{let t=(e=e||{pages:[],pageParams:[]}).pages.map(e=>e.map(e=>e.slug===a?{...e,thread_count:e.thread_count-1}:e));return{...e,pages:t}}),e.setQueryData(["list_collection_threads",{collection_slug:a.slice(-22)}],e=>{let t=(e=e||{pages:[],pageParams:[]}).pages.map(e=>e.filter(e=>e.uuid!==r));return{...e,pages:t}})),{previousThreads:n,previousCollections:i}},onSettled:(t,r,a,n)=>{r?(e.setQueryData(h,n.previousThreads),e.setQueryData(s.Xt,n.previousCollections)):(e.invalidateQueries({queryKey:h}),e.invalidateQueries({queryKey:s.Xt}))}});return{removeWidgetFromEntry:f,deleteAllThreads:_,deleteThread:w}}},81092:function(e,t,r){r.d(t,{G:function(){return l},f:function(){return d}});var a=r(78931),n=r(13417),i=r(52983),o=r(16644),c=r(52460);let l=8,u="recentItems",s=()=>{let e=localStorage.getItem(u);return e?JSON.parse(e):[]},d=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=(0,c.f)(),r=(0,a.NL)(),{isIncognito:d}=(0,o.Y)(),y=(0,n.a)([u],s,{enabled:e}),p=(0,i.useCallback)(e=>{d||r.setQueryData([u],function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=new URL(e.permalink,"http://example.com"),a={...e,permalink:r.pathname},n=[a,...t.filter(t=>t.id!==e.id&&t.permalink!==a.permalink)].slice(0,l);return localStorage.setItem(u,JSON.stringify(n)),n})},[r,d]),m=(0,i.useCallback)(e=>{r.setQueryData([u],function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!t)return;let a=r.filter(t=>t.id!==e&&!t.permalink.endsWith(e));return localStorage.setItem(u,JSON.stringify(a)),a})},[t,r]),h=(0,i.useCallback)(()=>{r.setQueryData([u],[]),localStorage.removeItem(u)},[r]);return{...y,addItemToSidebar:p,removeItemFromSidebar:m,clearSidebarRecentItems:h}}},69025:function(e,t,r){r.d(t,{AM:function(){return s},J1:function(){return c},M6:function(){return p},TF:function(){return i},Th:function(){return y},UF:function(){return f},eS:function(){return m},fz:function(){return u},jX:function(){return d},l8:function(){return l},mq:function(){return o},o_:function(){return n},tq:function(){return _},vE:function(){return h}});var a=r(51259);let n=async(e,t,r)=>{let n="sendUserFeedback";try{let i=await (0,a.FX)({urlPath:"p/api/v1/entry/feedback/".concat(e),timeoutMs:(0,a.vX)(),method:"POST",body:JSON.stringify({label:t,feedback:r}),headers:{"Content-Type":"application/json"},retryOnFailure:!1});return(0,a.HL)(n),i.json()}catch(e){throw(0,a.i8)(n,e),console.error("".concat(n," error:"),e),e}},i=async(e,t,r)=>{let n="updateArticleSectionTitle";if(r)try{let i=await (0,a.FX)({urlPath:"p/api/v1/article/section/title/".concat(e),timeoutMs:(0,a.vX)(),method:"PUT",body:JSON.stringify({read_write_token:r,title:t}),headers:{"Content-Type":"application/json"},retryOnFailure:!0});return(0,a.HL)(n),i.json()}catch(e){throw(0,a.i8)(n,e),console.error("".concat(n," error:"),e),e}},o=async(e,t,r)=>{let n="updateArticleSectionHeroOffset";if(r)try{let i=await (0,a.FX)({urlPath:"p/api/v1/article/section/hero_offset/".concat(e),timeoutMs:(0,a.vX)(),method:"PUT",body:JSON.stringify({read_write_token:r,hero_offset:t}),headers:{"Content-Type":"application/json"},retryOnFailure:!0});return(0,a.HL)(n),i.json()}catch(e){throw(0,a.i8)(n,e),console.error("".concat(n," error:"),e),e}},c=async(e,t)=>{let r="deleteArticleSection";if(e&&t)try{let n=await (0,a.FX)({urlPath:"p/api/v1/article/section/".concat(e),timeoutMs:(0,a.vX)(),method:"DELETE",body:JSON.stringify({read_write_token:t}),headers:{"Content-Type":"application/json"},retryOnFailure:!0}),i=await n.json();return(0,a.HL)(r),i}catch(e){throw(0,a.i8)(r,e),console.error("".concat(r," error:"),e),e}},l=async(e,t)=>{let r="updateArticleSectionsLayout";if(t&&0!==e.length)try{let n=await (0,a.FX)({urlPath:"p/api/v1/article/sections/layout",timeoutMs:(0,a.vX)(),method:"PUT",body:JSON.stringify({read_write_token:t,sections:e}),headers:{"Content-Type":"application/json"},retryOnFailure:!0}),i=await n.json();return(0,a.HL)(r),i}catch(e){throw(0,a.i8)(r,e),console.error("".concat(r," error:"),e),e}},u=async e=>{let{sectionUUID:t,mediaItem:r,targetIndex:n,rwToken:i,isNewMediaItem:o=!1}=e,c="updateArticleSectionImage";if(i)try{let e=await (0,a.FX)({urlPath:"p/api/v1/article/section/image/".concat(t),timeoutMs:(0,a.vX)(),method:"PUT",body:JSON.stringify({read_write_token:i,media_item:r,target_index:n,new_media_item:o}),headers:{"Content-Type":"application/json"},retryOnFailure:!0}),l=await e.json();return(0,a.HL)(c),l}catch(e){throw(0,a.i8)(c,e),console.error("".concat(c," error:"),e),e}},s=async function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i="addMediaItemToSectionSelectedImagesMutation";if(r)try{let o=await (0,a.FX)({urlPath:"p/api/v1/article/section/media/add/".concat(e),timeoutMs:(0,a.vX)(),method:"PUT",body:JSON.stringify({read_write_token:r,media_item:t,new_media_item:n}),headers:{"Content-Type":"application/json"},retryOnFailure:!0}),c=await o.json();return(0,a.HL)(i),c}catch(e){throw(0,a.i8)(i,e),console.error("".concat(i," error:"),e),e}},d=async(e,t,r)=>{let n="uploadImageToSectionMediaItemsMutation";if(r)try{let i=await (0,a.FX)({urlPath:"p/api/v1/article/section/upload_image/".concat(e),timeoutMs:(0,a.vX)(),method:"POST",body:JSON.stringify({read_write_token:r,content_type:t.type}),headers:{"Content-Type":"application/json"},retryOnFailure:!0}),o=await i.json();return(0,a.HL)(n),o}catch(e){throw(0,a.i8)(n,e),console.error("".concat(n," error:"),e),e}},y=async(e,t,r)=>{let n="addMediaItemToSectionSelectedImagesMutation";if(r)try{let i=await (0,a.FX)({urlPath:"p/api/v1/article/section/media/remove/".concat(e),timeoutMs:(0,a.vX)(),method:"PUT",body:JSON.stringify({read_write_token:r,media_item_image_url:t}),headers:{"Content-Type":"application/json"},retryOnFailure:!0}),o=await i.json();return(0,a.HL)(n),o}catch(e){throw(0,a.i8)(n,e),console.error("".concat(n," error:"),e),e}},p=async(e,t,r,n)=>{let i="reorderArticleSectionMutation";if(n)try{let o=await (0,a.FX)({urlPath:"p/api/v1/article/reorder/".concat(e),timeoutMs:(0,a.vX)(),method:"PUT",body:JSON.stringify({read_write_token:n,section_uuid:t,relative_move:r}),headers:{"Content-Type":"application/json"},retryOnFailure:!0}),c=await o.json();return(0,a.HL)(i),c}catch(e){throw(0,a.i8)(i,e),console.error("".concat(i," error:"),e),e}},m=async e=>{let t="terminateArticleSectionStreaming";if(e)try{let r=await (0,a.FX)({urlPath:"p/api/v1/article/section/terminate/".concat(e),timeoutMs:(0,a.vX)(),method:"POST",retryOnFailure:!0});return(0,a.HL)(t),r.json()}catch(e){throw(0,a.i8)(t,e),console.error("".concat(t," error:"),e),e}},h=async(e,t,r)=>{let n="addArticleSectionMediaItemMutation";if(r)try{let i=await (0,a.FX)({urlPath:"p/api/v1/article/section/add/media_item/".concat(e),timeoutMs:(0,a.vX)(),method:"PUT",body:JSON.stringify({read_write_token:r,media_item:t}),headers:{"Content-Type":"application/json"},retryOnFailure:!0}),o=await i.json();return(0,a.HL)(n),o}catch(e){throw(0,a.i8)(n,e),console.error("".concat(n," error:"),e),e}},f=async(e,t,r)=>{let n="removeWidgetFromEntryMutation";if(r)try{let i=await (0,a.$e)({urlPath:"rest/thread/entry/remove_widget",timeoutMs:(0,a.vX)(),method:"PUT",body:JSON.stringify({entry_uuid:e,read_write_token:r,url:t}),headers:{"Content-Type":"application/json"},retryOnFailure:!0}),o=await i.json();return(0,a.HL)(n),o}catch(e){throw(0,a.i8)(n,e),console.error("".concat(n," error:"),e),e}},_=async(e,t,r)=>{let n="toggleEmphasizeSources";try{let i=await (0,a.FX)({urlPath:"p/api/v1/article/emphasize_sources/".concat(e),timeoutMs:(0,a.vX)(),method:"PUT",body:JSON.stringify({read_write_token:t,value:r}),headers:{"Content-Type":"application/json"},retryOnFailure:!0}),o=await i.json();return(0,a.HL)(n),o}catch(e){throw(0,a.i8)(n,e),console.error("".concat(n," error:"),e),e}}}}]);