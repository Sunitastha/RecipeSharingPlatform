!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="eb884ae3-f718-4dd8-8d06-724fbeaad8c3",e._sentryDebugIdIdentifier="sentry-dbid-eb884ae3-f718-4dd8-8d06-724fbeaad8c3")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9988],{57329:function(e,t,l){l.r(t),l.d(t,{default:function(){return _}});var n=l(97458),i=l(52983),s=l(50030),r=l.n(s),a=l(1804),o=l(27481),d=l(40906),c=l(71870),u=l(44239),m=l(8369),h=l(28023),x=l(68644),v=l(72157),p=l(51865),f=l.n(p);let g=e=>{var t;let{submit:l,editQueryValue:s,setEditQueryValue:r,setIsEditingQuery:p,isEditingQuery:g,isFirstResult:j}=e,y=(0,a.useTranslations)("shared"),{trackEvent:b}=(0,d.h)(),{isMobileStyle:w,isMobileUserAgent:k}=(0,c.d)(),{isFailed:C,result:_,isReadonly:U,isSnapshotRender:N}=(0,o.T)(),I=null==_?void 0:_.backend_uuid,S=null==_?void 0:_.frontend_context_uuid,D=null==_?void 0:_.query_str,E=(0,i.useCallback)(()=>{if(l){b("confirm edit query click",{entryUUID:I,newQuery:s});let e=(0,u.Mp)();l({rawQuery:s,existingEntryUUID:I,redoSearch:!0,collection:null,newFrontendContextUUID:U?e:null,existingFrontendContextUUID:U?null:S,promptSource:"user",querySource:"edit"})}},[l,b,s,I,S,U]),T=(0,i.useCallback)(()=>{r(null!=D?D:""),p(!1),b("cancel edit query click",{entryUUID:I})},[r,D,p,b,I]),Z=(0,i.useCallback)(e=>{(0,m.Wk)(e)&&!k&&(e.preventDefault(),E())},[E,k]),R=""===s,M=(null!==(t=D.length)&&void 0!==t?t:0)>200;return(0,n.jsx)("div",{className:f()({"my-md md:my-lg":!N,"my-md":N}),children:g?(0,n.jsx)("div",{className:"flex w-full",children:(0,n.jsx)("div",{className:"grow",children:(0,n.jsx)(x.Z,{isMobileUserAgent:k,isMobileStyle:w,onKeyDown:Z,autoFocus:!0,size:"large",wrapperClassName:"grow",value:s,onChange:e=>r(e.target.value),inlineEditBlock:(0,n.jsxs)("div",{className:"flex items-center gap-x-xs pl-sm",children:[(0,n.jsx)(v.Z,{text:y("cancel"),size:"small",pill:!0,onClick:T}),(0,n.jsx)(v.Z,{text:y("save"),pill:!0,variant:R?"common":"primary",size:"small",disabled:R,onClick:E})]})})})}):(0,n.jsx)(h.Z,{variant:M?"baseSemi":"entry-title",as:j?"h1":"div",className:f()("whitespace-pre-line break-words [word-break:break-word] ",{"whitespace-pre-wrap":M}),children:C?(0,n.jsx)("div",{className:"flex items-center gap-x-sm",children:(0,n.jsx)("span",{children:null!=D?D:"Something went wrong..."})}):D})})};var j=l(46061),y=l(3011),b=l(7934);let w=r()(()=>Promise.all([l.e(8148),l.e(774),l.e(2966),l.e(3606),l.e(2407),l.e(7954),l.e(9914),l.e(6098),l.e(9159),l.e(8525),l.e(670)]).then(l.bind(l,64847)).then(e=>e.ThreadContent),{loadableGenerated:{webpack:()=>[64847]},loading:()=>(0,n.jsx)(j.a,{})}),k=r()(()=>Promise.all([l.e(774),l.e(2407),l.e(9159),l.e(2208)]).then(l.bind(l,2208)),{loadableGenerated:{webpack:()=>[2208]}}),C=(0,i.forwardRef)((e,t)=>{var l;let{result:s,inFlight:r,showAnimations:a=!1,isLastResult:m=!1,isFirstResult:h=!1,isSnapshotRender:x,idx:v,submit:p,onRelatedButtonClick:j,onTextSelectClick:C,showSurvey:_=!1,onBotStep:U,deleteLast:N,isReadonly:I}=e,{isMobileStyle:S}=(0,c.d)(),{trackEvent:D}=(0,d.h)(),[E,T]=(0,i.useState)(r),Z=(0,i.useRef)(null),R=(0,i.useRef)(r),[M,F]=(0,i.useState)(!1),[P,L]=(0,i.useState)(null!==(l=null==s?void 0:s.query_str)&&void 0!==l?l:""),A=(0,i.useMemo)(()=>s?(0,b.c)(s.text):[],[s]),O=(null==s?void 0:s.status)==="failed",B=(null==s?void 0:s.status)==="pending",q=null!=A&&A.length>0,G=!q||"FINAL"===A[A.length-1].step_type,H=(0,i.useMemo)(()=>s?(0,u.EH)(s):null,[s]),z=(0,i.useMemo)(()=>{var e;return O?[]:null!==(e=null==s?void 0:s.media_items)&&void 0!==e?e:[]},[null==s?void 0:s.media_items,O]),Q=(null==s?void 0:s.status)==="pending",W=!S&&G,J=(0,i.useMemo)(()=>z.filter(e=>"image"===e.medium||"map"===e.medium),[z]);(0,i.useEffect)(()=>{T(Q)},[Q]),(0,i.useEffect)(()=>{let e=h&&m,t=R.current&&!E;e&&t&&G&&(()=>{let e=setTimeout(()=>{D("engaged",{})},1e4);return()=>{clearTimeout(e)}})(),R.current=E},[E,h,G,m,D]);let V=J.length>0,Y=(0,i.useCallback)(e=>{var t,l,n;p({existingEntryUUID:null!==(t=null==s?void 0:s.backend_uuid)&&void 0!==t?t:void 0,newFrontendContextUUID:null,existingFrontendContextUUID:null==s?void 0:s.frontend_context_uuid,deletedUrls:e,rawQuery:null!==(l=null==s?void 0:s.query_str)&&void 0!==l?l:"",existingUuid:null!==(n=null==s?void 0:s.uuid)&&void 0!==n?n:void 0,collection:null,promptSource:"user",querySource:"citation_modal"})},[p,null==s?void 0:s.backend_uuid,null==s?void 0:s.frontend_context_uuid,null==s?void 0:s.query_str,null==s?void 0:s.uuid]);return s?(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{ref:t}),(0,n.jsx)("div",{ref:Z}),(0,n.jsx)(o.A,{idx:v,result:s,response:H,inFlight:E,isReadonly:I,isPending:B,hasSteps:q,isCopilot:q,mediaItems:z,filteredMediaItems:J,isFailed:O,isFinalStep:G,isSnapshotRender:x,isLastResult:m,children:(0,n.jsx)(y.ZP,{className:f()("pb-lg",{"border-b":!m&&!x,"min-h-[54vh]":E&&m&&!x}),children:(0,n.jsxs)("div",{className:x?V?"md:grid grid-cols-12 gap-md":"":"md:grid grid-cols-12 gap-xl",children:[(0,n.jsxs)("div",{className:"col-span-8",children:[(0,n.jsx)(g,{setEditQueryValue:L,isFirstResult:h,submit:p,setIsEditingQuery:F,isEditingQuery:M,editQueryValue:P}),(0,n.jsx)(w,{onRelatedButtonClick:j,onTextSelectClick:C,showSurvey:_,onBotStep:U,deleteLast:N,localRef:Z,showAnimations:a,submit:p,submitSourcesCuration:Y,setIsEditingQuery:F,isEditingQuery:M,setEditQueryValue:L})]}),(0,n.jsx)("div",{className:"col-span-4",children:W&&(0,n.jsx)(k,{isStreaming:B,showAnimations:a})})]})})})]}):(0,n.jsx)("div",{})});C.displayName="ThreadEntry";var _=C},79988:function(e,t,l){l.d(t,{j:function(){return eM}});var n=l(97458),i=l(52983),s=l(59842),r=l(50030),a=l.n(r),o=l(37506),d=l(76961),c=l(1804),u=l(6814),m=l(51045),h=l(80217),x=l(51004),v=l(72898),p=l(94306),f=l(68201),g=l(85002),j=l(71870),y=l(44239),b=l(3011),w=l(72157),k=l(7934),C=l(51865),_=l.n(C),U=l(35112),N=l(59815),I=l(77837),S=l.n(I);let D=e=>{let{left:t,width:l,lastResult:s,showStopButton:r,scrollToLatestEntry:a,showScrollButton:o,hasScrolled:C,setHasScrolled:I,existingFrontendContextUUID:D,moreThanOneResult:E,lastEntryUUID:T,isReadonly:Z}=e,R=(0,c.useTranslations)("askInput"),M=(0,c.useTranslations)("shared"),F=(0,u.useSearchParams)().get("q"),{submitQuery:P}=(0,p.e)(),L=(0,u.useRouter)(),A=(0,x.lG)(),O=(0,v.nO)(),{data:B}=(0,d.useSession)(),{inFlight:q}=(0,f.a0)(),{isMobileStyle:G}=(0,j.d)(),H=(0,i.useCallback)(e=>{let t=(0,y.Mp)();if(P({fork:Z,rawQuery:e.query,copilotOverride:!!A&&void 0,attachments:e.attachments,collection:null,newFrontendContextUUID:Z?t:null,existingFrontendContextUUID:Z?null:D,promptSource:"user",querySource:"followup"}),Z){let e=new URLSearchParams({q:"pending",newFrontendContextUUID:t}),l=new URL(window.location.href);l.pathname="search",l.search=e.toString();let n=l.toString();L.push(n)}},[Z,P,A,D,L]),{setUserInput:z,...Q}=(0,h.l)({clearInputOnSubmit:!0,onSubmit:S()(H,1e3,{leading:!0})}),W=(0,i.useMemo)(()=>{try{if(!s)throw Error("lastResult is null");let e=(0,k.c)(s.text);return null!=e&&"FINAL"!==e[e.length-1].step_type}catch(e){return!1}},[s]),J=(0,i.useCallback)(()=>{null==O||O.emit("perplexity_terminate",{entry_uuid:T})},[T,O]);return(0,i.useEffect)(()=>{""!=F&&z("")},[F,z]),t>0&&(0,n.jsx)(b.ZP,{style:{left:G?"0px":"".concat(t,"px"),width:G?"100%":"".concat(l,"px")},className:_()("pointer-events-none fixed z-10 grid-cols-12 gap-xl px-sm py-sm md:bottom-lg md:grid md:px-0",{"!hidden":W,"bottom-[64px]":B,"bottom-0":!B}),children:(0,n.jsxs)("div",{className:"pointer-events-auto md:col-span-8",children:[(0,n.jsx)(U.M,{initial:!1,children:o&&!C&&E&&(0,n.jsx)(N.E.div,{className:"mb-2 flex justify-center",initial:{opacity:0,y:5},animate:{opacity:1,y:0,transition:{delay:1,duration:.15,ease:"easeOut"}},exit:{opacity:0,transition:{duration:.1,ease:"easeOut"}},children:(0,n.jsx)("div",{className:"inline-flex rounded-full bg-offset shadow-md dark:bg-offsetDark",children:(0,n.jsx)(w.Z,{size:"small",variant:"common",icon:g.r5,layout:"center",pill:!0,onClick:()=>{a(),I(!0)},toolTip:M("scrollToBottom")})})})}),(0,n.jsx)(m.m,{...Q,isFollowUp:!0,disabled:q,placeholder:G&&q?"":R("placeholderFollowUp"),submitWillFork:Z,showStopButton:r,onStopButtonClick:J})]})})};var E=l(85570),T=l(89469),Z=l(88682),R=l(36974),M=l(16644),F=l(98918),P=l(37929),L=l(57329),A=l(64194),O=l(69153),B=l.n(O),q=l(49551),G=l(99407),H=l(28023),z=e=>{let{currentCollection:t,size:l,handleCollectionChange:i,viewOnly:s}=e,r=(0,c.useTranslations)("shared");if(s&&!t)return null;let a=(0,n.jsxs)(H.Z,{variant:"small"===l?"tiny":"smallBold",color:"light",className:"flex cursor-pointer select-none items-center gap-x-xs px-sm py-xs transition duration-300 hover:opacity-70",children:[(0,n.jsx)("div",{children:(0,n.jsx)(A.G,{icon:G.r8})}),(0,n.jsx)("div",{children:r("collection")})]});return(0,n.jsx)("div",{children:t?t?(0,n.jsx)(B(),{href:"/collections/".concat(t.slug),children:(0,n.jsxs)(H.Z,{variant:"small"===l?"tiny":"smallBold",className:"flex cursor-pointer select-none items-center gap-x-xs px-sm py-xs transition duration-300 hover:opacity-70",children:[(0,n.jsx)(q.B,{unified:t.emoji,size:"tiny"}),(0,n.jsx)("span",{className:"overflow-hidden truncate text-ellipsis",children:t.title})]})}):null:(0,n.jsx)("div",{onClick:s?void 0:i,children:a})})},Q=l(73565),W=l(57247),J=l(61218),V=l(71629),Y=l(10478),X=l(69914),$=l(81092),K=l(28964),ee=l(33979),et=l(20667),el=l(20634),en=l(34817),ei=l(27668);function es(e){let{utcTimestamp:t}=e,l=function(e){let t=(0,c.useTranslations)("threads.entry.expiration"),l=+new Date,n=(0,i.useMemo)(()=>+new Date(e+"Z"),[e])-l;return n<0?null:n>864e5?t("expiresInDays",{days:Math.floor(n/864e5)}):n>36e5?t("expiresInHours",{hours:Math.floor(n/36e5)}):t("expiresInMinutes",n>6e4?{minutes:Math.floor(n/6e4)}:{minutes:1})}(t);return l?(0,n.jsxs)(H.Z,{variant:"tiny",color:"light",className:"flex cursor-default items-center gap-x-xs",children:[(0,n.jsx)(A.G,{icon:ei.yZ}),(0,n.jsx)("span",{className:"truncate",suppressHydrationWarning:!0,children:l})]}):null}var er=l(44108),ea=l(51253),eo=l(49544),ed=()=>{let{firstResult:e,socialStats:t}=(0,f.a0)();if(!(null==e?void 0:e.backend_uuid))return(0,n.jsx)(n.Fragment,{});let l=t&&t.viewCount>0,i=t&&t.forkCount>0;return l||i?(0,n.jsxs)(b.ZP,{className:"flex items-center gap-x-sm ",children:[l&&(0,n.jsxs)(H.Z,{variant:"tiny",color:"light",className:"flex items-center gap-x-xs",children:[(0,n.jsx)(A.G,{size:"sm",fixedWidth:!0,icon:eo.Md}),(0,n.jsx)("div",{children:(0,y.uf)(t.viewCount)})]}),i&&(0,n.jsxs)(H.Z,{variant:"tiny",color:"light",className:"flex items-center gap-x-xs",children:[(0,n.jsx)(A.G,{size:"sm",fixedWidth:!0,icon:ea.MD}),(0,n.jsx)("div",{children:(0,y.uf)(t.forkCount)})]})]}):(0,n.jsx)(n.Fragment,{})},ec=l(56425),eu=l(71263);let em=i.memo(e=>{let{assistant:t,authorUsername:l,threadAccess:i,authorImage:s}=e,{threadMetadata:r}=(0,f.a0)(),a=!l,o=(0,el.k)();return(0,n.jsxs)("div",{className:"flex items-center gap-x-md",children:[!a&&(0,n.jsx)(b.ZP,{className:"hidden rounded-full md:block",children:(0,n.jsx)(en.Z,{image:null!=s?s:void 0,username:null!=l?l:void 0,showAvatar:!0,showCreatorLabel:!1,showEdit:!1,isCurrentUser:!1})}),null!=t&&"internet"!==t&&(0,n.jsx)(b.ZP,{className:"hidden rounded-full md:block",children:(0,n.jsx)(er.Z,{textVariant:"smallBold",assistant:t})}),!a&&(null!=i?i:0)>=ec.uv.PUBLIC_READ&&(0,n.jsx)("div",{className:"hidden md:block",children:(0,n.jsx)(ed,{})}),r.expiry_time?(0,n.jsx)("div",{className:"hidden md:block",children:(0,n.jsx)(es,{utcTimestamp:r.expiry_time})}):(0,n.jsx)("div",{className:"hidden md:block",children:(0,n.jsx)(eu.Z,{timestamp:r.updated_datetime,layoutType:"bottom",translations:o})})]})});var eh=l(78931),ex=l(32607),ev=l(43334),ep=l(27810),ef=l(81257),eg=l(52460),ej=l(18389),ey=l(25864);let eb=i.memo(e=>{var t,l;let{descriptionText:i,sharableURL:s}=e,{openModal:r}=(0,ee.X)(),a=(0,eg.f)(),o=(0,x.lG)(),d=(0,eh.NL)(),{threadMetadata:u}=(0,f.a0)(),m=u.rwToken,h=u.frontendContextUUID,v=u.contextUUID,p=u.collection,g=null!==(l=null!==(t=null==p?void 0:p.access)&&void 0!==t?t:u.thread_access)&&void 0!==l?l:ej.k6,j=(0,ev.O)(),y=(0,c.useTranslations)("search.thread"),b=e=>{e!==g&&(o?null!=v&&null!=m&&j(v,e,m,e=>{d.setQueryData(["results",{frontend_context_uuid:h}],t=>{if(!t)return;let[l,...n]=t;return[{...l,thread_access:e},...n]})}):r("loginModal",{pitchMessage:{title:y("shareLogin",{threads:"Threads"}),description:y("shareDescription",{threads:"Threads",collections:"Collections"})},origin:ec.FM.SHARE_DROPDOWN}))},w=(0,ef.o)({currentAccessLevel:g,onClick:b,isCollection:!1}),k=w[g],C=g>ec.uv.PRIVATE_READ,_=w[null==p?void 0:p.access],U=(0,n.jsxs)("div",{className:"p-sm",children:[null!=p?(0,n.jsxs)("div",{children:[(0,n.jsx)(H.Z,{variant:"baseSemi",children:y("viewAccess")}),(0,n.jsxs)("div",{className:"mt-sm rounded border p-sm",children:[(0,n.jsxs)(H.Z,{variant:"smallBold",color:"super",className:"flex items-center gap-x-xs",children:[(0,n.jsx)(A.G,{icon:null==_?void 0:_.icon}),null==_?void 0:_.text]}),(0,n.jsx)(H.Z,{variant:"tiny",color:"light",children:null==_?void 0:_.label})]}),(0,n.jsx)(H.Z,{variant:"tiny",className:"my-sm",children:y("viewAccessInheritance",{collection:p.title})})]}):null!=m?(0,n.jsxs)("div",{children:[(0,n.jsx)(H.Z,{variant:"baseSemi",children:y("viewAccess")}),(0,n.jsx)(ey.Z,{choices:w})]}):null,(0,n.jsx)(ex.Z,{descriptionText:i,shareHref:s,isSharable:C,hasMounted:a,icon:null==k?void 0:k.icon})]});return(0,n.jsx)(ep.Z,{isSharable:C,hasMounted:a,shareHref:s,EditorDropDownContent:U,icon:null==k?void 0:k.icon,onClick:()=>b(ec.uv.PUBLIC_READ)})}),ew=i.memo(e=>{let{visible:t,tweetDescriptionText:l,threadSharedSlug:s}=e,r=(0,eg.f)(),[a,o]=(0,i.useState)("");(0,i.useEffect)(()=>{let{protocol:e,host:t}=window.location;o("".concat(e,"//").concat(t,"/search/").concat(s))},[s]);let d=(0,i.useMemo)(()=>encodeURIComponent(r?(0,y.RP)(decodeURIComponent(a)):""),[a,r]),c=(0,i.useMemo)(()=>null!=l?"Perplexity AI: ".concat(l):"Perplexity AI",[l]),u=(0,i.useMemo)(()=>_()("transition-all duration-300 opacity flex items-center gap-x-xs md:gap-x-0",{"opacity-0":!t,"opacity-100":t}),[t]);return(0,n.jsx)("div",{className:u,children:t&&(0,n.jsx)(eb,{descriptionText:c,sharableURL:d})})});var ek=l(18693),eC=l(80937),e_=l(4028),eU=l(33542),eN=l(80370);let eI=i.memo(e=>{var t,l,s,r,a;let{entryUUID:o,frontendContextUUID:d,collection:m,isFirstResultPending:h}=e,[v,p]=(0,i.useState)(!1),g=(0,u.useRouter)(),k=(0,eg.f)(),C=(0,x.lG)(),{collections:_}=(0,Y.l)(),U=(0,T.p)(),{searchTerm:N}=(0,et.p)(),I=(0,V.J)(),{deleteThread:S}=(0,X.l)(),{openModal:D,closeModal:E}=(0,ee.X)(),{refetch:R,addItemToSidebar:M}=(0,$.f)(),{removeThreadFromCollection:F}=(0,J.Fb)(),{isLoading:P,threadMetadata:L}=(0,f.a0)(),{trackEvent:O}=(0,Z.WS)(),q=(0,c.useTranslations)("search.thread"),G=(0,c.useTranslations)("threadItem"),el=(0,c.useTranslations)("article"),en=(0,c.useTranslations)("shared"),{allowArticleCreation:ei}=(0,K.v)(),{isMobileStyle:es}=(0,j.d)(),er=L.privacy_state===ec.Jr.INCOGNITO;(0,i.useEffect)(()=>{let e=L.title||L.first_query,t=L.thread_url_slug;U&&k&&e&&t&&!er&&(M({id:o,variant:"thread",title:e,permalink:"/search/".concat(t,"?newFrontendContextUUID=").concat(d)}),R())},[L,U,k,d,o,M,R,er]);let ea=(0,i.useCallback)(()=>{O("click back button",{})},[O]),eo=(0,i.useCallback)(()=>{O("click logo",{})},[O]),ed=(0,i.useCallback)(()=>{o&&(O("delete thread from search result page click",{entryUUID:o}),S({entryUUID:o,callback:()=>g.push("/")}))},[S,o,g,O]),eu=(0,i.useCallback)(()=>{if(C){if(0===_.length)I.listUserCollections(e=>{if(0===e.length)D("collectionCreateOrEdit",{frontendContextUUID:d,existingCollection:null,searchTerm:N});else{var t;D("collectionSelectModal",{entryUUID:o,userCollections:e,currentCollection:m,searchTerm:null!==(t=L.first_query)&&void 0!==t?t:"",frontendContextUUID:d})}});else{var e;D("collectionSelectModal",{entryUUID:o,userCollections:_,currentCollection:m,searchTerm:null!==(e=L.first_query)&&void 0!==e?e:"",frontendContextUUID:d})}}else D("loginModal",{pitchMessage:{title:q("headerLogin",{threads:"Threads"})},origin:ec.FM.COLLECTIONS})},[m,I,o,d,C,D,N,q,L.first_query,_]),eh=(0,i.useCallback)(()=>{if(C){p(!0);let e=(0,y.Mp)();O("click convert thread to page",{oldContextUUID:L.contextUUID,newFrontendContextUUID:e});let t=new URLSearchParams({newFrontendContextUUID:e,existingResultsCacheUUID:d,existingContextBackendUUID:L.contextUUID}),l=new URL(window.location.href);l.pathname="page/new",l.search=t.toString();let n=l.toString();g.push(n)}else D("loginModal",{pitchMessage:{title:el("loginPrompt",{page:"Page"})},origin:ec.FM.THREAD_TO_ARTICLE})},[O,C,D,el,g,d,L.contextUUID,p]),ex=(!!U&&C||null!=m)&&!er,ev=(!!U&&C||L.title!=ek.i&&null!=L.title)&&!er,ep=ex&&ev;return(0,n.jsx)(b.ZP,{variant:"background",className:"sticky left-0 right-0 top-0 z-20 border-b md:mb-0 md:rounded-t-xl",children:(0,n.jsxs)("div",{className:"flex items-center justify-between gap-x-md px-md py-sm md:min-h-[53px]",children:[(0,n.jsxs)("div",{className:"flex items-center gap-x-sm md:hidden",children:[(0,n.jsx)(B(),{href:"/",onClick:eo,children:(0,n.jsx)(eN.Z,{size:"small",variant:"mark"})}),(0,n.jsx)(w.Z,{variant:"common",size:"small",text:en("new"),icon:eC.r8,href:"/",onClick:ea})]}),(0,n.jsx)("div",{children:!P&&(0,n.jsx)(em,{assistant:null!==(t=L.assistant)&&void 0!==t?t:null,authorUsername:null!==(l=L.author_username)&&void 0!==l?l:null,threadAccess:null!==(s=L.thread_access)&&void 0!==s?s:0,authorImage:null!==(r=L.author_image)&&void 0!==r?r:null,expiryTime:L.expiry_time})}),(0,n.jsxs)("div",{className:"hidden max-w-md grow items-center justify-center gap-x-xs text-center md:flex",children:[ex&&(0,n.jsx)(z,{currentCollection:m,handleCollectionChange:eu,viewOnly:!C||!U}),ep&&(0,n.jsx)(H.Z,{variant:"smallBold",color:"light",children:(0,n.jsx)(A.G,{icon:eU.D2})}),ev&&(0,n.jsx)(ek.Z,{title:L.title||L.first_query,contextUUID:L.contextUUID,rwToken:U,frontendContextUUID:d})]}),(0,n.jsxs)("div",{className:"flex items-center gap-x-sm",children:[(0,n.jsxs)("div",{className:"flex items-center gap-sm",children:[(0,n.jsx)(Q.Z,{show:k&&!h,onDelete:ed,onAddToCollection:eu,onSwapCollection:eu,onRemoveFromCollection:()=>{F({entryUUID:o,oldCollectionUUID:null==m?void 0:m.uuid,callback:E,frontendContextUUID:d})},currentCollection:m,rwToken:U,type:er?W.W.INCOGNITO_SEARCH:W.W.SEARCH}),ei&&!es&&!h&&!er&&(0,n.jsx)(w.Z,{text:G("convertThreadtoArticle"),size:"small",icon:e_.a_,onClick:eh,testId:"thread-article-create",variant:"border",isLoading:v,disabled:v})]}),es&&!h&&(0,n.jsx)(w.Z,{size:"small",variant:"primary",text:"Open in App",href:"/download-mobile",onClick:()=>{O("clicked open in app button in mweb thread header",{})}}),(0,n.jsx)(ew,{visible:!!L.thread_url_slug,tweetDescriptionText:L.title||L.first_query,threadSharedSlug:null!==(a=L.thread_url_slug)&&void 0!==a?a:void 0})]})]})})});var eS=l(76523),eD=e=>{var t,l,i,s;let{parentInfo:r}=e,a=(0,c.useTranslations)("threadItem"),o="article"===r.mode?"page":"search",d="";return(0,eS.rZ)(r)&&(null===(t=r.article_info)||void 0===t?void 0:t.title)?d=null!==(i=null===(l=r.article_info)||void 0===l?void 0:l.title)&&void 0!==i?i:"":"query_str"in r&&(d=null!==(s=r.query_str)&&void 0!==s?s:""),(0,n.jsx)(B(),{href:"/".concat(o,"/").concat(r.thread_url_slug),children:(0,n.jsx)(b.ZP,{variant:"offset",bgHover:"offsetPlus",className:"flex justify-between rounded-lg p-md md:mt-md",children:(0,n.jsxs)("div",{className:"",children:[(0,n.jsxs)(H.Z,{color:"light",variant:"tiny",className:"mb-xs flex items-center gap-x-xs",children:[(0,n.jsx)(A.G,{icon:ea.MD}),(0,n.jsx)("div",{children:a("followupTo")})]}),(0,n.jsx)(H.Z,{variant:"section-title",color:"light",className:"break-all line-clamp-1",children:d})]})})})},eE=l(26610),eT=l(36917);let eZ=a()({loader:()=>l.e(5943).then(l.bind(l,75943)),ssr:!1},{loadableGenerated:{webpack:()=>[75943]}}),eR=a()({loader:()=>l.e(5500).then(l.bind(l,65500)),ssr:!1},{loadableGenerated:{webpack:()=>[65500]}}),eM=e=>{var t,l,r,a,d;let{floatingSignupProps:c}=e,u=(0,T.p)(),m=(0,eE.X)(),[h,{left:x,width:v}]=(0,s.Z)(),{trackEvent:g}=(0,Z.WS)(),{thread:w,inFlight:k,inFlightLatest:C,lastResult:_,threadMetadata:U}=(0,f.a0)(),N=null===(t=w[0])||void 0===t?void 0:t.frontend_context_uuid,{isMobileStyle:I}=(0,j.d)(),{isIncognito:S}=(0,M.Y)(),{submitQuery:A,handleBotStep:O,deleteLastResult:B}=(0,p.e)(),{setAssistant:q,assistant:G,setIsCopilot:H,gpt4Limit:z}=(0,F.h)();(0,i.useEffect)(()=>{var e,t;q(null!==(t=null===(e=w[0])||void 0===e?void 0:e.search_focus)&&void 0!==t?t:"internet"),H(w.some(e=>"copilot"===e.mode)&&!!z&&z>0)},[]),(0,i.useEffect)(()=>{var e;q(null!==(e=U.assistant)&&void 0!==e?e:G)},[U.assistant]);let Q=(null==U?void 0:U.privacy_state)&&(S&&U.privacy_state!==ec.Jr.INCOGNITO||!S&&U.privacy_state===ec.Jr.INCOGNITO),W=(0,i.useMemo)(()=>!u&&(0,y.vl)(w)||Q,[w,u,Q]),J=0===w.length||k,V=null==_?void 0:_.backend_uuid,Y=(null==w?void 0:null===(l=w[0])||void 0===l?void 0:l.status)==="pending",X=(0,i.useCallback)(e=>{A(e)},[A]),$=(0,i.useCallback)(e=>{A(e)},[A]),{refs:K,scrollToLatestItem:ee,showScrollButton:et,hasScrolled:el,setHasScrolled:en,scrollToListItem:ei}=(0,R.$)({items:w,inFlight:k,inFlightLatest:C,rwToken:u}),es=(0,i.useCallback)(e=>{ei(e.existingEntryUUID,!0),A(e)},[ei,A]),er=(0,i.useMemo)(()=>w&&(null==_?void 0:_.status)!=="completed"&&(null==_?void 0:_.backend_uuid)!==void 0&&k,[w,null==_?void 0:_.status,null==_?void 0:_.backend_uuid,k]);return(0,i.useEffect)(()=>{(null==w?void 0:w.length)>=1&&(null==_?void 0:_.status)==="completed"&&g("thread viewed",{authorId:U.author_id,authorUsername:U.author_username,isThreadCreator:!!u})},[g]),(0,n.jsxs)(o.L.Content,{mobileHeader:!1,childrenWidth:"large",header:(0,n.jsx)(eI,{collection:null!==(a=U.collection)&&void 0!==a?a:null,entryUUID:null!==(d=null===(r=w[0])||void 0===r?void 0:r.backend_uuid)&&void 0!==d?d:null,frontendContextUUID:N,isFirstResultPending:Y}),floatingSignupProps:c,children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(P.u3,{firstResult:k?null:w[0]}),(0,n.jsx)("div",{className:"pb-[124px] pt-md md:pt-0",children:(0,n.jsxs)(b.ZP,{variant:"background",className:"relative",children:[U.parent_info&&(0,n.jsx)(eD,{parentInfo:U.parent_info}),(0,n.jsx)("div",{ref:h,children:w.map((e,t)=>{var l,s,r;let a=0===t,o=t===w.length-1;return(0,n.jsx)(i.Fragment,{children:(0,n.jsx)(E.Z,{fallback:(0,n.jsx)(eT.o,{description:null!==(l=null==e?void 0:e.text)&&void 0!==l?l:"Please try again later."}),children:(0,n.jsx)("div",{ref:K[t],children:(0,n.jsx)(L.default,{idx:t,result:e,inFlight:k,isReadonly:W,showAnimations:J&&o,submit:es,onRelatedButtonClick:X,onTextSelectClick:$,isLastResult:o,isFirstResult:a,onBotStep:t=>O(e,t),showSurvey:!!m,deleteLast:o&&1!==w.length?()=>{var e;return B({frontendContextUUID:null===(e=w[0])||void 0===e?void 0:e.frontend_context_uuid})}:void 0})},null==e?void 0:e.backend_uuid)})},null!==(r=null!==(s=null==e?void 0:e.uuid)&&void 0!==s?s:null==e?void 0:e.backend_uuid)&&void 0!==r?r:t)})}),(0,n.jsx)(D,{left:x,width:v,lastResult:_,lastEntryUUID:V,showStopButton:er,scrollToLatestEntry:ee,showScrollButton:et,hasScrolled:el,setHasScrolled:en,existingFrontendContextUUID:N,moreThanOneResult:w.length>1,isReadonly:W})]})})]}),(0,n.jsxs)("div",{className:"md:hidden",children:[(0,n.jsx)(eZ,{className:"mb-16",havePrimaryButton:!1}),!k&&I&&(0,n.jsx)(eR,{})]})]})}},51045:function(e,t,l){l.d(t,{m:function(){return v}});var n=l(97458),i=l(52983),s=l(1804),r=l(33979),a=l(89408),o=l(36),d=l(3011),c=l(72157),u=l(69192),m=l(59815),h=l(43172),x=l(35112);let v=i.memo(e=>{let{showStopButton:t,onStopButtonClick:l,...v}=e,{currentOpenedModal:p}=(0,r.X)(),f=(0,s.useTranslations)("main.askInput"),g=(0,i.useCallback)(e=>{"Escape"===e.key&&t&&l&&null===p&&(e.preventDefault(),l())},[l,t,p]);return(0,i.useEffect)(()=>(document.addEventListener("keydown",g),()=>{document.removeEventListener("keydown",g)}),[g]),(0,n.jsx)(d.ZP,{className:"w-full",children:(0,n.jsx)(u.A,{transition:{duration:.2,bounce:.2,type:"spring"},children:(0,n.jsx)(m.E.div,{layout:!0,layoutRoot:!0,className:"flex items-center gap-x-xs",children:(0,n.jsx)(h.S,{children:(0,n.jsxs)(x.M,{mode:"popLayout",initial:!1,children:[t&&(0,n.jsx)(m.E.div,{initial:{scale:.2,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.2,opacity:0},children:(0,n.jsx)(c.Z,{toolTip:f("stopGenerating"),variant:"rejecter",pill:!0,icon:o.oD,keyboardShortcut:["Esc"],onClick:l})},"stop-button"),(0,n.jsx)(m.E.div,{layout:!0,className:"grow",children:(0,n.jsx)(a.Z,{borderClass:"md:p-sm bg-offset dark:bg-offsetDark",hasShadow:!0,showFileUpload:!0,showCopilotToggle:!0,autofocus:null===p,querySource:v.submitWillFork?"fork":"followup",...v})},"ask-input")]})})})})})})},36974:function(e,t,l){l.d(t,{$:function(){return a}});var n=l(52983),i=l(52460),s=l(77837),r=l.n(s);let a=e=>{let{items:t,inFlight:l,inFlightLatest:s,rwToken:a,headerOffset:o=52}=e,[d,c]=(0,n.useState)(!1),[u,m]=(0,n.useState)(!1),h=(0,i.f)(),x=(0,n.useRef)(!0),v=(0,n.useMemo)(()=>!a&&t.every(e=>"pending"!==e.status),[t,a]),p=(0,n.useMemo)(()=>t.some(e=>"pending"===e.status),[t]),[f,g]=(0,n.useState)({}),[j,y]=(0,n.useState)({}),b=(0,n.useCallback)(function(e){var t,l;let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i="number"==typeof e?null===(t=f[e])||void 0===t?void 0:t.current:null===(l=j[e])||void 0===l?void 0:l.current;if(i){let e=i.getBoundingClientRect().top+window.scrollY-o;window.scrollTo({top:e,behavior:n?"smooth":"auto"})}},[f,j,o]),w=(0,n.useCallback)(()=>{b(t.length-1)},[b,t.length]);return(0,n.useEffect)(()=>{g(e=>{let l={...e},i={...j},s=!1;return t.forEach((e,t)=>{let r=e.backend_uuid;if(l[t]&&l[t].current)i[r]=l[t];else{let e=n.createRef();l[t]=e,i[r]=e,s=!0}}),Object.keys(l).forEach(e=>{t.some((t,l)=>l===Number(e))||(delete l[Number(e)],s=!0)}),s&&y(i),s?l:e})},[t.length,j,p]),(0,n.useEffect)(()=>{if(t.length<=1||!h)return;let e=window.location.hash;if(e&&!l&&x.current){try{let t=e.slice(1);t.length>3?b(t,!1):b(Number(t),!1)}catch(e){console.error(e)}return}s&&b(t.length-1)},[l,s,v,t.length,f,j,h,b]),(0,n.useEffect)(()=>{let e=r()(()=>{var e;let l=null===(e=f[t.length-1])||void 0===e?void 0:e.current;if(l){let e=l.getBoundingClientRect().top+window.scrollY-100,t=document.body.scrollHeight>window.innerHeight,n=window.innerHeight+window.scrollY>=document.body.scrollHeight-10;if(window.scrollY>=e||!t||n)d&&m(!0),c(!1);else{if(u)return;c(!0)}}},200);return e(),window.addEventListener("scroll",e),()=>{window.removeEventListener("scroll",e),e.cancel()}},[f,d,u,t.length]),{refs:f,scrollToLatestItem:w,scrollToListItem:b,showScrollButton:d&&!u,hasScrolled:u,setHasScrolled:m}}},25864:function(e,t,l){var n=l(97458);l(52983);var i=l(3011),s=l(69764);t.Z=e=>{let{choices:t,...l}=e;return(0,n.jsx)(i.ZP,{className:"mt-sm divide-y rounded md:border ",...l,children:t.map((e,t)=>(0,n.jsx)(s.s,{rounded:!1,...e},t))})}},36917:function(e,t,l){l.d(t,{o:function(){return a}});var n=l(97458),i=l(52983);let s=e=>{try{return JSON.parse(e)}catch(e){return null}},r="Please try again later.",a=i.memo(e=>{let{title:t="Sorry, something went wrong.",description:l=r,className:a,role:o,...d}=e,c=(0,i.useMemo)(()=>s(l),[l]);return c&&(l=r,console.warn("Tried to pass a JSON error description"),console.warn(c)),(0,n.jsxs)("div",{className:"mt-4 rounded-lg border-l-4 border-orange-500 bg-orange-100 p-4 text-left text-orange-700 ".concat(a),role:"alert",...d,children:[(0,n.jsx)("p",{className:"font-bold",children:t}),(0,n.jsx)("p",{children:l})]})})}}]);